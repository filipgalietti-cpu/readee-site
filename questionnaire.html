<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Started ‚Äî READEE</title>
    <meta name="description" content="Sign up for Readee's free reading program in under 2 minutes.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:wght@400;500;600;700;800&family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        :root{--indigo-900:#1e1b4b;--indigo-800:#272463;--indigo-700:#312e81;--indigo-600:#4338ca;--indigo-500:#6366f1;--indigo-400:#818cf8;--indigo-300:#a5b4fc;--indigo-200:#c7d2fe;--indigo-100:#e0e7ff;--indigo-50:#eef2ff;--violet-500:#8b5cf6;--amber-400:#fbbf24;--emerald-400:#34d399;--emerald-500:#10b981;--rose-400:#fb7185;--white:#fff;--gray-50:#f9fafb;--gray-100:#f3f4f6;--gray-200:#e5e7eb;--gray-300:#d1d5db;--gray-400:#9ca3af;--gray-500:#6b7280;--gray-600:#4b5563;--gray-700:#374151;--gray-800:#1f2937;--gray-900:#111827;--radius:16px;--radius-sm:10px;--radius-lg:24px}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'DM Sans',-apple-system,sans-serif;color:var(--gray-800);background:linear-gradient(160deg,var(--indigo-50) 0%,var(--white) 40%,#f5f0ff 100%);min-height:100vh;-webkit-font-smoothing:antialiased}
        h1,h2,h3,h4,h5{font-family:'Bricolage Grotesque',serif}
        nav{padding:16px 24px;background:rgba(255,255,255,.8);backdrop-filter:blur(12px);border-bottom:1px solid rgba(0,0,0,.05)}
        .nav-inner{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between}
        .nav-logo{font-family:'Bricolage Grotesque',serif;font-weight:800;font-size:1.5rem;color:var(--indigo-700);text-decoration:none}
        .nav-logo span{color:var(--indigo-400)}
        .nav-back{display:inline-flex;align-items:center;gap:6px;color:var(--gray-500);text-decoration:none;font-size:.9rem;font-weight:500;transition:color .2s}
        .nav-back:hover{color:var(--indigo-600)}
        .container{max-width:560px;margin:0 auto;padding:48px 24px 80px}
        .progress-wrap{margin-bottom:40px;animation:fadeUp .4s ease both}
        .progress-header{display:flex;justify-content:space-between;margin-bottom:10px}
        .progress-label{font-size:.8rem;font-weight:600;color:var(--indigo-600);text-transform:uppercase;letter-spacing:1px}
        .progress-count{font-size:.8rem;color:var(--gray-400);font-weight:500}
        .progress-track{height:6px;background:var(--indigo-100);border-radius:50px;overflow:hidden}
        .progress-fill{height:100%;background:linear-gradient(90deg,var(--indigo-500),var(--violet-500));border-radius:50px;transition:width .5s cubic-bezier(.4,0,.2,1)}
        .step{display:none;animation:fadeUp .5s ease both}
        .step.active{display:block}
        .step-card{background:var(--white);border-radius:var(--radius-lg);padding:40px 36px;box-shadow:0 8px 30px rgba(30,27,75,.08),0 0 0 1px rgba(99,102,241,.06)}
        .step-card h2{font-size:1.6rem;font-weight:800;color:var(--indigo-900);margin-bottom:6px;letter-spacing:-.5px}
        .step-card .subtitle{font-size:.95rem;color:var(--gray-500);margin-bottom:32px;line-height:1.6}

        /* Welcome header - colorful */
        .welcome-header{text-align:center;margin-bottom:32px}
        .welcome-wave{font-size:3rem;display:block;margin-bottom:16px;animation:wave 1.5s ease-in-out infinite}
        .welcome-header h2{font-size:1.8rem;background:linear-gradient(135deg,var(--indigo-600),var(--violet-500));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:8px}
        .welcome-header p{font-size:.95rem;color:var(--gray-500);line-height:1.6}
        .welcome-badges{display:flex;justify-content:center;gap:10px;margin-top:20px;flex-wrap:wrap}
        .welcome-badge{display:inline-flex;align-items:center;gap:5px;padding:6px 14px;border-radius:50px;font-size:.78rem;font-weight:600}
        .welcome-badge.free{background:#d1fae5;color:#065f46}
        .welcome-badge.fast{background:#e0e7ff;color:var(--indigo-700)}
        .welcome-badge.safe{background:#fef3c7;color:#92400e}

        @keyframes wave{0%,100%{transform:rotate(0deg)}15%{transform:rotate(14deg)}30%{transform:rotate(-8deg)}40%{transform:rotate(14deg)}50%{transform:rotate(-4deg)}60%{transform:rotate(10deg)}70%{transform:rotate(0deg)}}

        .role-options{display:grid;grid-template-columns:1fr 1fr;gap:14px}
        .role-card{border:2px solid var(--gray-200);border-radius:var(--radius);padding:24px 20px;text-align:center;cursor:pointer;transition:all .25s;background:var(--white)}
        .role-card:hover{border-color:var(--indigo-300);background:var(--indigo-50)}
        .role-card.selected{border-color:var(--indigo-500);background:var(--indigo-50);box-shadow:0 0 0 3px rgba(99,102,241,.15)}
        .role-card .role-icon{font-size:2rem;margin-bottom:10px}
        .role-card h3{font-size:1rem;font-weight:700;color:var(--indigo-900);margin-bottom:4px}
        .role-card p{font-size:.8rem;color:var(--gray-500);line-height:1.4}
        .form-group{margin-bottom:20px}
        .form-group label{display:block;font-size:.85rem;font-weight:600;color:var(--gray-700);margin-bottom:6px}
        .form-group input,.form-group select,.form-group textarea{width:100%;padding:12px 16px;border:2px solid var(--gray-200);border-radius:var(--radius-sm);font-size:.95rem;font-family:'DM Sans',sans-serif;color:var(--gray-800);background:var(--white);transition:border-color .2s,box-shadow .2s;outline:none}
        .form-group textarea{resize:vertical;min-height:80px}
        .form-group input:focus,.form-group select:focus,.form-group textarea:focus{border-color:var(--indigo-400);box-shadow:0 0 0 3px rgba(99,102,241,.1)}
        .form-group input::placeholder,.form-group textarea::placeholder{color:var(--gray-400)}
        .form-row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
        .children-list{display:flex;flex-direction:column;gap:14px;margin-bottom:20px}
        .child-card{background:var(--gray-50);border:1px solid var(--gray-200);border-radius:var(--radius);padding:18px 20px;display:grid;grid-template-columns:auto 1fr auto;gap:14px;align-items:center;animation:fadeUp .3s ease both}
        .child-num{width:36px;height:36px;border-radius:50%;background:var(--indigo-100);color:var(--indigo-600);display:flex;align-items:center;justify-content:center;font-family:'Bricolage Grotesque',serif;font-weight:800;font-size:.9rem;flex-shrink:0}
        .child-fields{display:grid;grid-template-columns:1fr 1fr;gap:10px}
        .child-fields input,.child-fields select{width:100%;padding:10px 12px;border:2px solid var(--gray-200);border-radius:8px;font-size:.88rem;font-family:'DM Sans',sans-serif;color:var(--gray-800);background:var(--white);transition:border-color .2s;outline:none}
        .child-fields input:focus,.child-fields select:focus{border-color:var(--indigo-400);box-shadow:0 0 0 3px rgba(99,102,241,.1)}
        .child-fields input::placeholder{color:var(--gray-400)}
        .remove-child{width:32px;height:32px;border:none;background:none;color:var(--gray-400);cursor:pointer;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.3rem;transition:all .2s;flex-shrink:0;line-height:1}
        .remove-child:hover{background:#fee2e2;color:#ef4444}
        .add-child-btn{display:inline-flex;align-items:center;gap:6px;background:none;border:2px dashed var(--indigo-200);border-radius:var(--radius-sm);padding:12px 20px;color:var(--indigo-500);font-weight:600;font-size:.9rem;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all .2s;width:100%;justify-content:center}
        .add-child-btn:hover{background:var(--indigo-50);border-color:var(--indigo-400)}
        .class-size-options{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:20px}
        .class-size-btn{border:2px solid var(--gray-200);border-radius:var(--radius-sm);padding:14px 8px;text-align:center;cursor:pointer;transition:all .2s;background:var(--white);font-family:'DM Sans',sans-serif}
        .class-size-btn:hover{border-color:var(--indigo-300);background:var(--indigo-50)}
        .class-size-btn.selected{border-color:var(--indigo-500);background:var(--indigo-50);box-shadow:0 0 0 3px rgba(99,102,241,.15)}
        .class-size-btn .size-num{font-family:'Bricolage Grotesque',serif;font-weight:800;font-size:1.2rem;color:var(--indigo-700);display:block}
        .class-size-btn .size-label{font-size:.72rem;color:var(--gray-500);font-weight:500}
        .grade-chips{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:20px}
        .grade-chip{border:2px solid var(--gray-200);border-radius:50px;padding:8px 18px;cursor:pointer;transition:all .2s;background:var(--white);font-size:.88rem;font-weight:600;font-family:'DM Sans',sans-serif;color:var(--gray-600);user-select:none}
        .grade-chip:hover{border-color:var(--indigo-300);background:var(--indigo-50)}
        .grade-chip.selected{border-color:var(--indigo-500);background:var(--indigo-100);color:var(--indigo-700)}
        .btn-row{display:flex;gap:12px;margin-top:28px}
        .btn-primary{flex:1;display:inline-flex;align-items:center;justify-content:center;gap:8px;background:var(--indigo-600);color:var(--white);padding:14px 28px;border-radius:50px;border:none;font-weight:700;font-size:1rem;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all .25s;box-shadow:0 4px 16px rgba(99,102,241,.25)}
        .btn-primary:hover{background:var(--indigo-700);transform:translateY(-1px);box-shadow:0 6px 24px rgba(99,102,241,.35)}
        .btn-primary:disabled{opacity:.4;cursor:not-allowed;transform:none;box-shadow:none}
        .btn-back{display:inline-flex;align-items:center;justify-content:center;gap:6px;background:none;border:2px solid var(--gray-200);padding:14px 24px;border-radius:50px;color:var(--gray-600);font-weight:600;font-size:.95rem;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all .2s}
        .btn-back:hover{border-color:var(--gray-300);background:var(--gray-50)}
        .success-card{text-align:center;padding:50px 36px;position:relative;overflow:hidden}
        .success-icon{width:72px;height:72px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:2rem;animation:popIn .5s cubic-bezier(.175,.885,.32,1.275) both}
        .success-icon.green{background:linear-gradient(135deg,var(--emerald-400),var(--emerald-500))}
        .success-icon.indigo{background:linear-gradient(135deg,var(--indigo-400),var(--violet-500))}
        .success-card h2{margin-bottom:10px}
        .success-card .subtitle{margin-bottom:28px}
        .success-summary{background:var(--gray-50);border-radius:var(--radius);padding:20px 24px;text-align:left;margin-bottom:28px}
        .success-summary h4{font-size:.8rem;text-transform:uppercase;letter-spacing:1px;color:var(--gray-400);margin-bottom:12px}
        .summary-row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--gray-100);font-size:.9rem}
        .summary-row:last-child{border:none}
        .summary-row .label{color:var(--gray-500)}
        .summary-row .value{font-weight:600;color:var(--gray-800)}
        .child-summary{display:flex;align-items:center;gap:8px}
        .child-dot{width:8px;height:8px;border-radius:50%}
        .outreach-notice{background:var(--indigo-50);border:1px solid var(--indigo-200);border-radius:var(--radius);padding:24px;text-align:center;margin-bottom:28px}
        .outreach-notice .notice-icon{font-size:1.5rem;margin-bottom:8px}
        .outreach-notice h4{font-size:.95rem;color:var(--indigo-800);margin-bottom:6px;font-weight:700}
        .outreach-notice p{font-size:.85rem;color:var(--gray-500);line-height:1.6}
        .trust-footer{text-align:center;margin-top:24px;font-size:.82rem;color:var(--gray-400)}
        .trust-footer span{margin:0 8px}

        /* Confetti */
        .confetti-canvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:999}

        @keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
        @keyframes popIn{from{opacity:0;transform:scale(.5)}to{opacity:1;transform:scale(1)}}
        @media(max-width:500px){.step-card{padding:28px 22px}.role-options{grid-template-columns:1fr}.form-row{grid-template-columns:1fr}.child-card{grid-template-columns:auto 1fr auto}.child-fields{grid-template-columns:1fr}.class-size-options{grid-template-columns:repeat(2,1fr)}}
    </style>
</head>
<body>
    <canvas class="confetti-canvas" id="confettiCanvas"></canvas>

    <nav><div class="nav-inner"><a href="index.html" class="nav-logo">READ<span>EE</span></a><a href="index.html" class="nav-back">‚Üê Back to home</a></div></nav>

    <div class="container">
        <div class="progress-wrap">
            <div class="progress-header">
                <span class="progress-label" id="progressLabel">Getting Started</span>
                <span class="progress-count" id="progressCount">Step 1 of 3</span>
            </div>
            <div class="progress-track"><div class="progress-fill" id="progressFill" style="width:33%"></div></div>
        </div>

        <!-- STEP 1: Role - Colorful Welcome -->
        <div class="step active" id="step1">
            <div class="step-card">
                <div class="welcome-header">
                    <span class="welcome-wave">üëã</span>
                    <h2>Welcome to Readee!</h2>
                    <p>Let's get you set up in under 2 minutes.<br>First, tell us who you are.</p>
                    <div class="welcome-badges">
                        <span class="welcome-badge free">‚úì 100% Free</span>
                        <span class="welcome-badge fast">‚ö° 2-Minute Setup</span>
                        <span class="welcome-badge safe">üîí No Credit Card</span>
                    </div>
                </div>
                <div class="role-options">
                    <div class="role-card" onclick="selectRole('parent',this)">
                        <div class="role-icon">üë®‚Äçüë©‚Äçüëß</div>
                        <h3>I'm a Parent</h3>
                        <p>Set up reading practice for my child at home</p>
                    </div>
                    <div class="role-card" onclick="selectRole('teacher',this)">
                        <div class="role-icon">üë©‚Äçüè´</div>
                        <h3>I'm a Teacher</h3>
                        <p>Bring Readee to my classroom as supplemental practice</p>
                    </div>
                </div>
                <div class="btn-row"><button class="btn-primary" id="step1Next" disabled onclick="goToStep(2)">Continue ‚Üí</button></div>
            </div>
        </div>

        <!-- STEP 2: Info -->
        <div class="step" id="step2">
            <div class="step-card">
                <div style="font-size:2.2rem;margin-bottom:16px;text-align:center">‚úèÔ∏è</div>
                <h2>Tell us about you</h2>
                <p class="subtitle">We'll use this to set up your account.</p>
                <div class="form-row">
                    <div class="form-group"><label for="firstName">First Name</label><input type="text" id="firstName" placeholder="First name" oninput="checkStep2()"></div>
                    <div class="form-group"><label for="lastName">Last Name</label><input type="text" id="lastName" placeholder="Last name" oninput="checkStep2()"></div>
                </div>
                <div class="form-group"><label for="email">Email Address</label><input type="email" id="email" placeholder="you@email.com" oninput="checkStep2()"></div>
                <div class="btn-row">
                    <button class="btn-back" onclick="goToStep(1)">‚Üê Back</button>
                    <button class="btn-primary" id="step2Next" disabled onclick="goToStep(3)">Continue ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- STEP 3 PARENT: Children -->
        <div class="step" id="step3Parent">
            <div class="step-card">
                <div style="font-size:2.2rem;margin-bottom:16px;text-align:center">üìö</div>
                <h2>Add your children</h2>
                <p class="subtitle">Tell us their first name and grade. You can always add more later.</p>
                <div class="children-list" id="childrenList"></div>
                <button class="add-child-btn" onclick="addChild()" id="addChildBtn">+ Add a child</button>
                <div class="btn-row">
                    <button class="btn-back" onclick="goToStep(2)">‚Üê Back</button>
                    <button class="btn-primary" id="step3ParentNext" disabled onclick="submitParent()">Create My Account ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- STEP 3 TEACHER: Classroom -->
        <div class="step" id="step3Teacher">
            <div class="step-card">
                <div style="font-size:2.2rem;margin-bottom:16px;text-align:center">üè´</div>
                <h2>Tell us about your classroom</h2>
                <p class="subtitle">This helps us find the right plan for you and your students.</p>
                <div class="form-group"><label for="schoolName">School Name</label><input type="text" id="schoolName" placeholder="e.g. Lincoln Elementary" oninput="checkStep3Teacher()"></div>
                <div class="form-group">
                    <label>What grade(s) do you teach?</label>
                    <div class="grade-chips">
                        <div class="grade-chip" onclick="toggleGrade(this,'k')">Kindergarten</div>
                        <div class="grade-chip" onclick="toggleGrade(this,'1st')">1st</div>
                        <div class="grade-chip" onclick="toggleGrade(this,'2nd')">2nd</div>
                        <div class="grade-chip" onclick="toggleGrade(this,'3rd')">3rd</div>
                        <div class="grade-chip" onclick="toggleGrade(this,'4th')">4th</div>
                        <div class="grade-chip" onclick="toggleGrade(this,'5th')">5th</div>
                    </div>
                </div>
                <div class="form-group">
                    <label>How many students in your class?</label>
                    <div class="class-size-options">
                        <div class="class-size-btn" onclick="selectClassSize(this,'1-10')"><span class="size-num">1‚Äì10</span><span class="size-label">students</span></div>
                        <div class="class-size-btn" onclick="selectClassSize(this,'11-20')"><span class="size-num">11‚Äì20</span><span class="size-label">students</span></div>
                        <div class="class-size-btn" onclick="selectClassSize(this,'21-30')"><span class="size-num">21‚Äì30</span><span class="size-label">students</span></div>
                        <div class="class-size-btn" onclick="selectClassSize(this,'30+')"><span class="size-num">30+</span><span class="size-label">students</span></div>
                    </div>
                </div>
                <div class="form-group"><label for="teacherNotes">Anything else we should know? <span style="color:var(--gray-400);font-weight:400">(optional)</span></label><textarea id="teacherNotes" placeholder="e.g. I have several students with IEPs, we use Fundations for phonics..."></textarea></div>
                <div class="btn-row">
                    <button class="btn-back" onclick="goToStep(2)">‚Üê Back</button>
                    <button class="btn-primary" id="step3TeacherNext" disabled onclick="submitTeacher()">Request My Classroom Setup ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- STEP 4 PARENT: Success -->
        <div class="step" id="step4Parent">
            <div class="step-card success-card">
                <div class="success-icon green">‚úì</div>
                <h2>You're all set! üéâ</h2>
                <p class="subtitle">Your Readee account is ready. Here's a summary:</p>
                <div class="success-summary" id="parentSummary"></div>
                <a href="https://readee-app2-0.vercel.app/signup" class="btn-primary" style="text-decoration:none;display:inline-flex">Go to My Dashboard ‚Üí</a>
            </div>
            <div class="trust-footer">Check your email for a welcome guide with tips to get started</div>
        </div>

        <!-- STEP 4 TEACHER: Outreach -->
        <div class="step" id="step4Teacher">
            <div class="step-card success-card">
                <div class="success-icon indigo">üì¨</div>
                <h2>We're on it!</h2>
                <p class="subtitle">Thanks for your interest in bringing Readee to your classroom.</p>
                <div class="outreach-notice">
                    <div class="notice-icon">ü§ù</div>
                    <h4>A team member will reach out shortly!</h4>
                    <p>We'll help you find the right plan for your classroom, walk you through setup, and answer any questions about how Readee fits into your curriculum.</p>
                </div>
                <div class="success-summary" id="teacherSummary"></div>
                <a href="index.html" class="btn-primary" style="text-decoration:none;display:inline-flex">‚Üê Back to Readee</a>
            </div>
            <div class="trust-footer">We'll email you at the address you provided ¬∑ Typically within 24 hours</div>
        </div>
    </div>

    <script>
        let selectedRole='',children=[],childIdCounter=0,selectedGrades=[],selectedClassSize='';
        const gradeOptions=[{value:'',label:'Select grade'},{value:'kindergarten',label:'Kindergarten'},{value:'1st',label:'1st Grade'},{value:'2nd',label:'2nd Grade'},{value:'3rd',label:'3rd Grade'},{value:'4th',label:'4th Grade'},{value:'5th',label:'5th Grade'}];
        const gradeLabels={'k':'Kindergarten','1st':'1st Grade','2nd':'2nd Grade','3rd':'3rd Grade','4th':'4th Grade','5th':'5th Grade'};
        const childColors=['linear-gradient(135deg,#818cf8,#8b5cf6)','linear-gradient(135deg,#34d399,#0d9488)','linear-gradient(135deg,#fbbf24,#fb7185)','linear-gradient(135deg,#fb7185,#a855f7)','linear-gradient(135deg,#38bdf8,#818cf8)'];

        function selectRole(role,el){
            selectedRole=role;
            document.querySelectorAll('.role-card').forEach(c=>c.classList.remove('selected'));
            el.classList.add('selected');
            document.getElementById('step1Next').disabled=false;
        }

        function updateProgress(step,total){
            const labels=['Getting Started','Your Info',selectedRole==='teacher'?'Your Classroom':'Your Readers'];
            document.getElementById('progressFill').style.width=Math.round((step/total)*100)+'%';
            document.getElementById('progressLabel').textContent=labels[step-1]||'';
            document.getElementById('progressCount').textContent='Step '+step+' of '+total;
        }

        function goToStep(num){
            document.querySelectorAll('.step').forEach(s=>s.classList.remove('active'));
            if(num===1){document.getElementById('step1').classList.add('active');updateProgress(1,3);document.querySelector('.progress-wrap').style.display='block'}
            else if(num===2){document.getElementById('step2').classList.add('active');updateProgress(2,3);document.querySelector('.progress-wrap').style.display='block'}
            else if(num===3){
                if(selectedRole==='parent'){document.getElementById('step3Parent').classList.add('active');if(children.length===0)addChild()}
                else{document.getElementById('step3Teacher').classList.add('active')}
                updateProgress(3,3);document.querySelector('.progress-wrap').style.display='block';
            }
        }

        function checkStep2(){
            const f=document.getElementById('firstName').value.trim(),l=document.getElementById('lastName').value.trim(),e=document.getElementById('email').value.trim();
            document.getElementById('step2Next').disabled=!(f&&l&&e&&e.includes('@')&&e.includes('.'));
        }

        // === PARENT: Children ===
        function checkStep3Parent(){
            const ok=children.length>0&&children.every(c=>{
                const n=document.getElementById('childName_'+c.id);
                const g=document.getElementById('childGrade_'+c.id);
                return n&&g&&n.value.trim()&&g.value;
            });
            document.getElementById('step3ParentNext').disabled=!ok;
        }

        function addChild(){
            if(children.length>=5)return;
            childIdCounter++;
            const id=childIdCounter;
            children.push({id:id});
            const el=document.createElement('div');
            el.className='child-card';
            el.id='childCard_'+id;
            el.innerHTML=`
                <div class="child-num">${children.length}</div>
                <div class="child-fields">
                    <input type="text" id="childName_${id}" placeholder="First name" oninput="checkStep3Parent()">
                    <select id="childGrade_${id}" onchange="checkStep3Parent()">
                        ${gradeOptions.map(o=>'<option value="'+o.value+'">'+o.label+'</option>').join('')}
                    </select>
                </div>
                <button class="remove-child" onclick="removeChild(${id})" title="Remove">&times;</button>
            `;
            document.getElementById('childrenList').appendChild(el);
            if(children.length>=5)document.getElementById('addChildBtn').style.display='none';
            checkStep3Parent();
        }

        function removeChild(id){
            if(children.length<=1)return; // keep at least one
            children=children.filter(c=>c.id!==id);
            const card=document.getElementById('childCard_'+id);
            if(card)card.remove();
            // re-number
            const nums=document.querySelectorAll('#childrenList .child-num');
            nums.forEach((el,i)=>el.textContent=i+1);
            if(children.length<5)document.getElementById('addChildBtn').style.display='flex';
            checkStep3Parent();
        }

        // === TEACHER: Classroom ===
        function toggleGrade(el,grade){
            el.classList.toggle('selected');
            if(selectedGrades.includes(grade))selectedGrades=selectedGrades.filter(g=>g!==grade);
            else selectedGrades.push(grade);
            checkStep3Teacher();
        }

        function selectClassSize(el,size){
            selectedClassSize=size;
            document.querySelectorAll('.class-size-btn').forEach(b=>b.classList.remove('selected'));
            el.classList.add('selected');
            checkStep3Teacher();
        }

        function checkStep3Teacher(){
            const school=document.getElementById('schoolName').value.trim();
            document.getElementById('step3TeacherNext').disabled=!(school.length>0&&selectedGrades.length>0&&selectedClassSize.length>0);
        }

        // === API ===
        const API_URL='https://readee-app2-0.vercel.app/api/signups';

        async function sendSignup(data){
            try{
                const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
                if(!res.ok)console.error('Signup API error:',res.status);
            }catch(err){console.error('Signup API error:',err)}
        }

        // === SUBMIT ===
        function submitParent(){
            const fn=document.getElementById('firstName').value.trim(),ln=document.getElementById('lastName').value.trim(),em=document.getElementById('email').value.trim();

            // Collect children data
            const childrenData=children.map(c=>({
                name:document.getElementById('childName_'+c.id).value.trim(),
                grade:document.getElementById('childGrade_'+c.id).value
            }));

            // Send to API (fire and forget ‚Äî don't block the UI)
            sendSignup({role:'parent',first_name:fn,last_name:ln,email:em,children:childrenData});

            // Build summary HTML
            let h='<h4>Account Summary</h4><div class="summary-row"><span class="label">Name</span><span class="value">'+fn+' '+ln+'</span></div><div class="summary-row"><span class="label">Email</span><span class="value">'+em+'</span></div><div class="summary-row"><span class="label">Children</span><span class="value">';
            childrenData.forEach((c,i)=>{
                const gl=gradeOptions.find(o=>o.value===c.grade);
                h+='<div class="child-summary"><div class="child-dot" style="background:'+childColors[i%childColors.length]+'"></div>'+c.name+' ‚Äî '+(gl?gl.label:c.grade)+'</div>';
            });
            h+='</span></div>';
            document.getElementById('parentSummary').innerHTML=h;
            document.querySelectorAll('.step').forEach(s=>s.classList.remove('active'));
            document.getElementById('step4Parent').classList.add('active');
            document.querySelector('.progress-wrap').style.display='none';
            launchConfetti();
        }

        function submitTeacher(){
            const fn=document.getElementById('firstName').value.trim(),ln=document.getElementById('lastName').value.trim(),em=document.getElementById('email').value.trim(),sc=document.getElementById('schoolName').value.trim();
            const notes=document.getElementById('teacherNotes').value.trim();

            // Parse class size to number
            const sizeMap={'1-10':10,'11-20':20,'21-30':30,'30+':35};
            const classNum=sizeMap[selectedClassSize]||null;

            // Send to API
            sendSignup({role:'teacher',first_name:fn,last_name:ln,email:em,school_name:sc,grades:selectedGrades,class_size:classNum,notes:notes||null});

            // Build summary HTML
            const gd=selectedGrades.map(g=>gradeLabels[g]||g).join(', ');
            document.getElementById('teacherSummary').innerHTML='<h4>Your Request</h4><div class="summary-row"><span class="label">Name</span><span class="value">'+fn+' '+ln+'</span></div><div class="summary-row"><span class="label">Email</span><span class="value">'+em+'</span></div><div class="summary-row"><span class="label">School</span><span class="value">'+sc+'</span></div><div class="summary-row"><span class="label">Grades</span><span class="value">'+gd+'</span></div><div class="summary-row"><span class="label">Class Size</span><span class="value">'+selectedClassSize+' students</span></div>';
            document.querySelectorAll('.step').forEach(s=>s.classList.remove('active'));
            document.getElementById('step4Teacher').classList.add('active');
            document.querySelector('.progress-wrap').style.display='none';
            launchConfetti();
        }

        // === CONFETTI ===
        function launchConfetti(){
            const canvas=document.getElementById('confettiCanvas');
            const ctx=canvas.getContext('2d');
            canvas.width=window.innerWidth;
            canvas.height=window.innerHeight;
            const colors=['#6366f1','#8b5cf6','#a5b4fc','#fbbf24','#34d399','#fb7185','#38bdf8','#f59e0b','#818cf8'];
            const pieces=[];

            for(let i=0;i<150;i++){
                pieces.push({
                    x:Math.random()*canvas.width,
                    y:Math.random()*canvas.height-canvas.height,
                    w:Math.random()*10+5,
                    h:Math.random()*6+3,
                    color:colors[Math.floor(Math.random()*colors.length)],
                    vy:Math.random()*3+2,
                    vx:(Math.random()-0.5)*4,
                    rotation:Math.random()*360,
                    rv:Math.random()*8-4,
                    opacity:1
                });
            }

            let frame=0;
            function draw(){
                ctx.clearRect(0,0,canvas.width,canvas.height);
                let alive=false;
                pieces.forEach(p=>{
                    if(p.opacity<=0)return;
                    alive=true;
                    p.y+=p.vy;
                    p.x+=p.vx;
                    p.rotation+=p.rv;
                    p.vy+=0.05;
                    if(frame>60)p.opacity-=0.008;
                    ctx.save();
                    ctx.translate(p.x,p.y);
                    ctx.rotate(p.rotation*Math.PI/180);
                    ctx.globalAlpha=Math.max(0,p.opacity);
                    ctx.fillStyle=p.color;
                    ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
                    ctx.restore();
                });
                frame++;
                if(alive)requestAnimationFrame(draw);
                else ctx.clearRect(0,0,canvas.width,canvas.height);
            }
            draw();
        }
    </script>
</body>
</html>
